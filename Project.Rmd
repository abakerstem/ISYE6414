---
title: "Reg-Project"
author: "Alayna Baker"
date: "2024-03-07"
output: html_document
---

```{r}
library(dplyr)
setwd("/Users/alaynabaker/Downloads")
data0 <- read.csv("diabetes_prediction_dataset.csv")

data0$gender <- ifelse(data0$gender == "Male", 0, 1)

# recoding smoking_history to be numerical 
# should maybe recode No Info to be N/A instead of 0? 
data1 <- data0 %>% mutate(smoking_history=recode(smoking_history, 
                                              "No Info" = 0,
                                               "never" = 1, 
                                               "not current" = 2, 
                                               "former" = 3,
                                               "current" = 4, 
                                               "ever" = 5 ))
# visualizing data 
head(data1)
summary(data1)

# first linear regression model 
model0 <- lm(diabetes ~., data=data1)
summary(model0)

# how many people have hba1c > 6.5 (definition of diabetes) but aren't flagged for diabetes? 
diab <- subset(data1, HbA1c_level >= 6.5 & diabetes == 0)
nrow(diab)

```

```{r}
# visualizing data 
par(mfrow = c(2,2))
plot(data1$gender, data1$diabetes,main="Gender Against Diabetes", xlab="Gender", ylab="Diabetes")
plot(data1$age,data1$diabetes, main="Age Against Diabetes", xlab="Age", ylab="Diabetes")
plot(data1$hypertension, data1$diabetes,main="Hypertension Against Diabetes", xlab="Hypertension", ylab="Diabetes")
plot(data1$heart_disease,data1$diabetes, main="Heart Disease Against Diabetes", xlab="Heart Disease", ylab="Diabetes")
plot(data1$smoking_history,data1$diabetes, main="Smoking History Against Diabetes", xlab="Smoking History", ylab="Diabetes")
plot(data1$bmi,data1$diabetes, main="BMI Against Diabetes", xlab="BMI", ylab="Diabetes")
plot(data1$HbA1c_level,data1$diabetes, main="HbA1c Against Diabetes", xlab="Hba1c", ylab="Diabetes")
plot(data1$blood_glucose_level, data1$diabetes,main="Blood Glucose Level Against Diabetes", xlab="Blood Glucose Level", ylab="Diabetes")
```



